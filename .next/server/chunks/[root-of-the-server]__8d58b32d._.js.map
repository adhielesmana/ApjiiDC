{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/auth/check/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { cookies } from \"next/headers\";\nimport jwt from \"jsonwebtoken\";\n\nconst clearAuthCookies = (response: NextResponse) => {\n  const cookieOptions = {\n    maxAge: 0,\n    path: \"/\",\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"strict\" as const,\n  };\n\n  response.cookies.set(\"token\", \"\", cookieOptions);\n  response.cookies.set(\"user\", \"\", cookieOptions);\n  return response;\n};\n\nconst createAuthResponse = (\n  authenticated: boolean,\n  data: any = null,\n  error: string | null = null,\n  status = 200\n) => {\n  const response = NextResponse.json(\n    {\n      authenticated,\n      token: authenticated ? data?.token : null,\n      user: authenticated ? data?.user : null,\n      error: error || undefined,\n    },\n    { status }\n  );\n\n  if (!authenticated) {\n    return clearAuthCookies(response);\n  }\n\n  return response;\n};\n\nexport async function GET() {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"token\");\n    const userCookie = cookieStore.get(\"user\");\n\n    // Check if cookies exist\n    if (!token?.value || !userCookie?.value) {\n      return createAuthResponse(false, null, \"Token Not Found\", 401);\n    }\n\n    // Get clean token value\n    const tokenValue = token.value.replace(/^Bearer\\s/, \"\");\n\n    // Validate token\n    const decoded = jwt.decode(tokenValue);\n    if (!decoded || typeof decoded !== \"object\" || !decoded.exp) {\n      return createAuthResponse(false, null, \"Invalid Token Format\", 401);\n    }\n\n    // Check token expiration\n    const isExpired = Math.floor(Date.now() / 1000) >= decoded.exp;\n    if (isExpired) {\n      return createAuthResponse(false, null, \"Token Expired\", 401);\n    }\n\n    // Valid auth - return user data\n    return createAuthResponse(true, {\n      token: token.value,\n      user: JSON.parse(userCookie.value),\n    });\n  } catch (error) {\n    console.error(\"Auth check error:\", error);\n    return createAuthResponse(false, null, \"Authentication Error\", 401);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,CAAC;IACxB,MAAM,gBAAgB;QACpB,QAAQ;QACR,MAAM;QACN,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;IACZ;IAEA,SAAS,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI;IAClC,SAAS,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI;IACjC,OAAO;AACT;AAEA,MAAM,qBAAqB,CACzB,eACA,OAAY,IAAI,EAChB,QAAuB,IAAI,EAC3B,SAAS,GAAG;IAEZ,MAAM,WAAW,gJAAY,CAAC,IAAI,CAChC;QACE;QACA,OAAO,gBAAgB,MAAM,QAAQ;QACrC,MAAM,gBAAgB,MAAM,OAAO;QACnC,OAAO,SAAS;IAClB,GACA;QAAE;IAAO;IAGX,IAAI,CAAC,eAAe;QAClB,OAAO,iBAAiB;IAC1B;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,QAAQ,YAAY,GAAG,CAAC;QAC9B,MAAM,aAAa,YAAY,GAAG,CAAC;QAEnC,yBAAyB;QACzB,IAAI,CAAC,OAAO,SAAS,CAAC,YAAY,OAAO;YACvC,OAAO,mBAAmB,OAAO,MAAM,mBAAmB;QAC5D;QAEA,wBAAwB;QACxB,MAAM,aAAa,MAAM,KAAK,CAAC,OAAO,CAAC,aAAa;QAEpD,iBAAiB;QACjB,MAAM,UAAU,kJAAG,CAAC,MAAM,CAAC;QAC3B,IAAI,CAAC,WAAW,OAAO,YAAY,YAAY,CAAC,QAAQ,GAAG,EAAE;YAC3D,OAAO,mBAAmB,OAAO,MAAM,wBAAwB;QACjE;QAEA,yBAAyB;QACzB,MAAM,YAAY,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK,SAAS,QAAQ,GAAG;QAC9D,IAAI,WAAW;YACb,OAAO,mBAAmB,OAAO,MAAM,iBAAiB;QAC1D;QAEA,gCAAgC;QAChC,OAAO,mBAAmB,MAAM;YAC9B,OAAO,MAAM,KAAK;YAClB,MAAM,KAAK,KAAK,CAAC,WAAW,KAAK;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,mBAAmB,OAAO,MAAM,wBAAwB;IACjE;AACF","debugId":null}}]
}